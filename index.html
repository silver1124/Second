<html>
  <body>
      <form onsubmit="savetoLocalStorage(event)">

        <h1>Add User</h1>
          <label>Name:</label>
          <input type="text" name="username" id = 'idname' required/>

          <br>
          <label>Email:</label>
          <input type="text" name="emailid" id = 'idemail' required/>
          
          <br>
        <button>Submit</button>
      </form>

      <ul id = 'listofitems'></ul>
      <script src = "https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
      <script>
        function savetoLocalStorage(event){
            event.preventDefault();
            
            const name = event.target.username.value;
            const email = event.target.emailid.value;
            const obj ={
                name ,
                email
            }

            axios.post("https://crudcrud.com/api/267430ee4cdc4806afd37549f19090f6/appointmentData", obj)
              .then((response) => {
                showuser(response.data)
              })
              .catch((err) => {
                console.log(err) 
              })
              
            //localStorage.setItem(obj.email, JSON.stringify(obj));
            //showuser(obj);

        }
        function showuser(obj){
            const parElement = document.getElementById('listofitems');
            const childElement = document.createElement('li');
            const deletebtn = document.createElement('input');
            deletebtn.type = 'button';
            deletebtn.name = 'deletebtn';
            deletebtn.value = 'Delete';
            deletebtn.onclick = function(){
                localStorage.removeItem(obj.email)
                parElement.removeChild(childElement);
            }
            const editbtn = document.createElement('input');
            editbtn.type = 'button'
            editbtn.name = 'editbtn'
            editbtn.value = 'Edit'
            editbtn.onclick = function(){
                localStorage.removeItem(obj.email);
                parElement.removeChild(childElement);
                document.getElementById('idname').value = obj.name
                document.getElementById('idemail').value = obj.email
            }
            childElement.textContent= obj.name +' - '+obj.email;
            childElement.appendChild(deletebtn);
            childElement.appendChild(editbtn);
            parElement.appendChild(childElement);
        }
      </script>
    </section>
  </body>
</html>